[gd_scene load_steps=14 format=3 uid="uid://blrh806e5yssb"]

[ext_resource type="PackedScene" uid="uid://ksrtlxdhhtvb" path="res://assets/enemy/enemy_pillar/Enemy_Pillar.glb" id="2_n7fcf"]
[ext_resource type="Script" uid="uid://bdbn4rfa0b3c3" path="res://assets/enemy/enemy_pillar/enemy_pillar.gd" id="2_vdavr"]
[ext_resource type="Script" uid="uid://dhefwn5nr2dpi" path="res://assets/enemy/enemy_base/enemy_target.gd" id="2_xmv3r"]
[ext_resource type="PackedScene" uid="uid://dkp5y0u8pd54k" path="res://assets/common/health/health.tscn" id="3_04hg2"]
[ext_resource type="Script" uid="uid://c57rja73wx5tf" path="res://assets/enemy/enemy_pillar/pillar_idle.gd" id="3_5qy18"]
[ext_resource type="Script" uid="uid://da5q7hn5atihn" path="res://assets/enemy/enemy_pillar/pillar_follow.gd" id="4_5qy18"]
[ext_resource type="PackedScene" uid="uid://bpycvx6icpx8o" path="res://assets/common/enemy_health_bar/health_bar.tscn" id="4_aj476"]
[ext_resource type="Script" uid="uid://cwrysv1cwpwav" path="res://assets/enemy/enemy_pillar/pillar_attack.gd" id="4_n7fcf"]
[ext_resource type="Script" uid="uid://jgmelc3l8nm4" path="res://assets/enemy/enemy_pillar/ground_detection.gd" id="6_sicnd"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_5qy18"]
height = 6.0
radius = 0.47168

[sub_resource type="BoxShape3D" id="BoxShape3D_5qy18"]
size = Vector3(1, 6, 0.8)

[sub_resource type="BoxShape3D" id="BoxShape3D_sicnd"]
size = Vector3(0.985, 6, 0.920174)

[sub_resource type="BoxShape3D" id="BoxShape3D_vdavr"]
size = Vector3(0.920166, 0.496948, 0.571671)

[node name="EnemyPillar" type="AnimatableBody3D" node_paths=PackedStringArray("state_nodes")]
collision_layer = 4
collision_mask = 14
sync_to_physics = false
script = ExtResource("2_vdavr")
state_nodes = {
0: NodePath("PillarIdle"),
1: NodePath("PillarFollow"),
3: NodePath("PillarAttack")
}

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.000732422, 3, 0.410694)
shape = SubResource("CylinderShape3D_5qy18")

[node name="EnemyTarget" type="Node" parent="."]
script = ExtResource("2_xmv3r")

[node name="Health" parent="." instance=ExtResource("3_04hg2")]
max_health = 250

[node name="HealthBar" parent="." node_paths=PackedStringArray("health") instance=ExtResource("4_aj476")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 6.78036, 0.40316)
health = NodePath("../Health")
size = Vector2(160, 20)

[node name="Enemy_Pillar" parent="." instance=ExtResource("2_n7fcf")]

[node name="PillarIdle" type="Node3D" parent="." node_paths=PackedStringArray("controller", "target")]
script = ExtResource("3_5qy18")
controller = NodePath("..")
target = NodePath("../EnemyTarget")

[node name="PillarFollow" type="Node3D" parent="." node_paths=PackedStringArray("controller", "target")]
script = ExtResource("4_5qy18")
controller = NodePath("..")
target = NodePath("../EnemyTarget")

[node name="WaitTimer" type="Timer" parent="PillarFollow"]
wait_time = 0.15
one_shot = true

[node name="PillarAttack" type="Area3D" parent="." node_paths=PackedStringArray("controller", "target")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.183784)
collision_layer = 4
collision_mask = 6
monitoring = false
monitorable = false
script = ExtResource("4_n7fcf")
controller = NodePath("..")
target = NodePath("../EnemyTarget")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="PillarAttack"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.13819, 0.430124)
shape = SubResource("BoxShape3D_5qy18")

[node name="WaitTimer" type="Timer" parent="PillarAttack"]
wait_time = 2.0
one_shot = true

[node name="Timer" type="Timer" parent="PillarAttack"]
wait_time = 1.5
one_shot = true

[node name="GroundDetection" type="Area3D" parent="." node_paths=PackedStringArray("controller")]
collision_layer = 4
monitorable = false
script = ExtResource("6_sicnd")
controller = NodePath("..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="GroundDetection"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.006, 3, 0.415149)
shape = SubResource("BoxShape3D_sicnd")

[node name="EndDetection" type="Area3D" parent="."]
collision_layer = 4
monitoring = false
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="EndDetection"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0150146, 5.77015, 0.128103)
shape = SubResource("BoxShape3D_vdavr")

[node name="StatusEffects" type="Node" parent="."]

[connection signal="died" from="Health" to="." method="_on_health_died"]
[connection signal="body_entered" from="PillarAttack" to="PillarAttack" method="_on_body_entered"]
